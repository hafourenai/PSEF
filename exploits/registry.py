from typing import Dict, Optional
from models.enums import VulnerabilityType
from core.http_client import SecureHTTPClient
from exploits.sqli import AdvancedSQLiExploiter

class ExploitRegistry:
    """Registry for vulnerability-specific exploit modules"""
    
    def __init__(self, http_client: SecureHTTPClient):
        self.http_client = http_client
        self._exploits = {}
        self._initialize_exploits()
        
    def _initialize_exploits(self):
        """Initialize and register all exploit modules"""
        # SQL Injection
        sqli_exploiter = AdvancedSQLiExploiter(self.http_client)
        self._exploits[VulnerabilityType.SQL_INJECTION] = sqli_exploiter
        
        # Add other exploits here as they are implemented
        
    def get_exploit(self, vulnerability_type: VulnerabilityType):
        """Retrieve exploit module for a given vulnerability type"""
        return self._exploits.get(vulnerability_type)
